<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Detalhes do Produto - Personalized Gift Shop</title>
    <link rel="stylesheet" href="css/pag-produtos.css">
</head>
<body>
    <header>
        <div class="logo"><img src="imagens/logomarca V3.png" alt=""></div>
        <div class="site-name">Personalized Gift Shop</div>
        <div class="header-actions">
            <form id="search-form" action="resultados.html" method="GET">
                <input type="search" id="search-input" name="q" placeholder="Buscar..." required>
                <button type="submit" aria-label="Buscar">游댌</button>
            </form>
<a href="carrinho.html" class="cart-icon" aria-label="Carrinho de Compras">
    游<span id="cart-count" style="background-color: red; color: white; border-radius: 50%; padding: 2px 6px; font-size: 0.7em; vertical-align: top; display: none;">0</span>
</a>        </div>
    </header>

    <nav class="main-nav">
        <ul>
            <li><a href="index.html" class="nav-link">In칤cio</a></li>
        </ul>
    </nav>

    <main>
        <div id="detalhe-produto-container">
            <div id="produto-imagem-container">
                <img id="produto-imagem" src="https://via.placeholder.com/400x400?text=Carregando..." alt="Imagem do produto">
            </div>
            <div id="produto-info-container">
                <h1 id="produto-nome">Carregando nome...</h1>
                <p id="produto-preco">R$ --,--</p>
                <p id="produto-descricao">Descri칞칚o do produto aparecer치 aqui...</p>
                
                <button id="btn-add-carrinho" class="btn-produto-acao">Adicionar ao Carrinho</button>
                
                <!-- O BOT츾O AGORA 칄 UM LINK (<a>) PARA NAVEGA칂츾O -->
                <a id="btn-personalizar" class="btn-produto-acao" href="metodos-personalizacao.html">Personalizar Produto</a>
            </div>
        </div>
    </main>

    <footer>
        <!-- O conte칰do do footer permanece o mesmo -->
        <div class="footer-container">
            <div class="footer-column">
                <h4>Institucional</h4>
                <ul>
                    <li><a href="index.html?section=about">Sobre N칩s</a></li>
                    <li><a href="termos.html">Termos e Condi칞칫es</a></li>
                    <li><a href="privacidade.html">Pol칤tica de Privacidade</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Atendimento</h4>
                <ul>
                    <li><a href="mailto:contato@personalizedgiftshop.com.br">contato@personalizedgiftshop.com.br</a></li>
                    <li><a href="tel:+5511999999999">(11) 99999-9999</a></li>
                    <li>Seg.  Sex. das 9h 맙 18h</li>
                </ul>
            </div>
            <div class="footer-column">
                <h4>Redes Sociais</h4>
                <div class="social-icons">
                    <a href="#" aria-label="Instagram">IG</a>
                    <a href="#" aria-label="Facebook">FB</a>
                    <a href="#" aria-label="Pinterest">PI</a>
                    <a href="#" aria-label="Tik Tok">TK</a>
                    <a href="#" aria-label="Twitter">X</a>
                </div>
            </div>
            <div class="footer-column">
                <h4>Newsletter</h4>
                <p>Receba novidades e promo칞칫es!</p>
                <form id="newsletter-form">
                    <input type="email" placeholder="Seu e-mail" required>
                    <button type="submit">Assinar</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <div class="payment-methods">
                <p>Formas de Pagamento:</p>
                <span>PIX</span> <span>VISA</span> <span>MASTERCARD</span> <span>ELO</span>
            </div>
            <div class="copyright">
                <p>춸 2025 Personalized Gift Shop - Todos os direitos reservados.</p>
            </div>
        </div>
    </footer>


    <script src="js/script.js"></script>

    <!-- ======== IN칈CIO DO C칍DIGO A SER ADICIONADO ======== -->
    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const btnAdicionar = document.getElementById('btn-add-carrinho');
        
        // Pega o ID do produto diretamente da URL da p치gina
        const urlParams = new URLSearchParams(window.location.search);
        const produtoId = urlParams.get('id');

        // Se o bot칚o existir e tivermos um ID de produto
        if (btnAdicionar && produtoId) {
            btnAdicionar.addEventListener('click', () => {
                // 1. Obter o carrinho atual do localStorage
                const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
                
                // 2. Pega a personaliza칞칚o salva na p치gina anterior, se existir
                const personalizacao = localStorage.getItem('produtoPersonalizado');

                // 3. Cria o objeto do produto com os dados CORRETOS da p치gina
                const produto = {
                    id: produtoId, // CORRE칂츾O: Usando o ID din칙mico da URL
                    name: document.getElementById('produto-nome').textContent,
                    price: parseFloat(document.getElementById('produto-preco').textContent.replace('R$ ', '').replace(',', '.')),
                    image: document.getElementById('produto-imagem').src,
                    quantity: 1,
                    customization: personalizacao || null // Adiciona a arte personalizada se ela existir
                };

                // 4. Verifica se o produto (com a mesma personaliza칞칚o) j치 est치 no carrinho
                const itemExistente = carrinho.find(item => item.id === produto.id && item.customization === produto.customization);

                if (itemExistente) {
                    // Se j치 existe, apenas aumenta a quantidade
                    itemExistente.quantity++;
                } else {
                    // Se n칚o existe, adiciona o novo produto
                    carrinho.push(produto);
                }

                // 5. Salva o carrinho atualizado de volta no localStorage
                localStorage.setItem('carrinho', JSON.stringify(carrinho));
                
                // 6. Limpa a personaliza칞칚o tempor치ria para n칚o aplic치-la ao pr칩ximo produto
                if (personalizacao) {
                    localStorage.removeItem('produtoPersonalizado');
                }

                // 7. Feedback para o usu치rio e atualiza칞칚o do 칤cone
                alert(`"${produto.name}" foi adicionado ao carrinho!`);
                atualizarContadorCarrinhoHeader();
            });
        }
        
        // Fun칞칚o para atualizar o contador (pode ser colocada em um script.js global, mas a deixamos aqui por seguran칞a)
        const atualizarContadorCarrinhoHeader = () => {
            const carrinho = JSON.parse(localStorage.getItem('carrinho')) || [];
            const totalItens = carrinho.reduce((acc, item) => acc + item.quantity, 0);
            const contador = document.getElementById('cart-count');
            if(contador) {
                contador.textContent = totalItens;
                contador.style.display = totalItens > 0 ? 'inline' : 'none';
            }
        };
        
        // Garante que o contador esteja atualizado ao carregar a p치gina
        atualizarContadorCarrinhoHeader();
    });
    </script>

    <script src="js/script.js"></script>
</body>
</html>